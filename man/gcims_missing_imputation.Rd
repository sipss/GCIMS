% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/imputation_functions.R
\name{gcims_missing_imputation}
\alias{gcims_missing_imputation}
\title{Missing Values Imputation}
\usage{
gcims_missing_imputation(dir_in, peak_table_with_na, peak_list_foms)
}
\arguments{
\item{dir_in}{Input directory. Where input data files are loaded
from. It should be the one with the baseline removed.}

\item{peak_table_with_na}{Peak table that contains missing values}

\item{peak_list_foms}{Peak list containing all the figures of merit.}
}
\value{
A Set of S3 objects.
}
\description{
Missing Values Imputation
}
\details{
\code{gcims_missing_imputation} calculates the volume of the ROIs that
have missing values. It uses the coordinates of the reference ROI for each
cluster and subistitue the missing value by the volume in this region without
baseline.
}
\examples{
dir_in <- system.file("extdata", package = "GCIMS")
roi_selection <- tempfile("dir")
fom <- tempfile("dir")
pl <- gcims_rois_selection(dir_in, roi_selection, samples = c(3, 7), noise_level = 3)
clust <- group_peak_list(
  pl,
  distance_method = "sd_scaled_euclidean",
  clustering = list(method = "kmedoids", Nclusters = 13)
)
peak_list_foms <- gcims_figures_of_merit(
  dir_in = roi_selection,
  dir_out = fom,
  samples = 3,
  peak_list = clust$peak_list_clustered
)
peak_table <- build_peak_table(peak_list_foms, aggregate_conflicting_peaks = max)
# Ideally dir_in should point to baseline corrected, but we skip this
# here for brevity.
peak_table_with_na <- peak_table$peak_table
peak_table_imputed <- gcims_missing_imputation(
  dir_in = fom,
  peak_table_with_na = peak_table_with_na,
  peak_list_foms = peak_list_foms
)
head(peak_table_imputed)
}
\seealso{
Other Imputation functions: 
\code{\link{gcims_peak_imputation}()}
}
\concept{Imputation functions}
