<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Creating a workflow step • GCIMS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Creating a workflow step">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GCIMS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/creating-a-workflow-step.html">Creating a workflow step</a>
    </li>
    <li>
      <a href="../articles/importing-custom-data-formats.html">Importing custom data formats</a>
    </li>
    <li>
      <a href="../articles/introduction-to-gcims.html">Introduction to GCIMS</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Creating a workflow step</h1>
            
      

      <div class="hidden name"><code>creating-a-workflow-step.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GCIMS</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette we show how samples can be modified in a batch,
using delayed operations. GCIMS uses delayed evaluations were possible,
so dataset modifications can be executed in a more efficient way and
without using too much RAM.</p>
<p>You may want to read this if you want to add support for a new
algorithm that modifies all the samples in a dataset.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The folder where we will download the samples:</span></span>
<span><span class="va">samples_directory</span> <span class="op">&lt;-</span> <span class="st">"threeketones"</span></span>
<span></span>
<span><span class="co"># Download the ketones dataset:</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/download_three_ketones_dataset.html">download_three_ketones_dataset</a></span><span class="op">(</span><span class="va">samples_directory</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Download successful"</span><span class="op">)</span></span>
<span><span class="op">}</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"The download of the samples did not succeed. The vignette can't continue."</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">conditionMessage</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/knit_exit.html" class="external-link">knit_exit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Download successful</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="batch-modifying-all-samples">Batch modifying all samples<a class="anchor" aria-label="anchor" href="#batch-modifying-all-samples"></a>
</h2>
<p>You will first have to define a function that takes one sample as an
argument and returns that sample modified:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cutDrift_Sample</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">dt_from</span>, <span class="va">dt_to</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># dt_from and dt_to are indices of the drift time vector.</span></span>
<span>  <span class="co"># This function crops a sample in the drift time axis.</span></span>
<span>  </span>
<span>  <span class="co"># Check that we are given a sample</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"GCIMSSample"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Internal error, this will never happen"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># You can use internal slots, or accessor functions. Accessors are more reliable</span></span>
<span>  <span class="co"># because the class internal representation may change in the future</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GCIMSSample-methods.html">subset</a></span><span class="op">(</span><span class="va">x</span>, dt_idx <span class="op">=</span> <span class="va">dt_from</span><span class="op">:</span><span class="va">dt_to</span><span class="op">)</span></span>
<span>  <span class="co">#x@data &lt;- x@data[dt_from:dt_to,]</span></span>
<span>  <span class="co">#x@drift_time &lt;- x@drift_time[dt_from:dt_to]</span></span>
<span></span>
<span>  <span class="co"># Check that we return a valid sample:</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">validObject</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"The sample is not valid."</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Then you need a function that applies to the whole dataset and
returns the dataset. You can use this template for now:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cutDrift_Dataset</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">dt_from</span>, <span class="va">dt_to</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">delayed_op</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DelayedOperation.html">DelayedOperation</a></span><span class="op">(</span></span>
<span>      name <span class="op">=</span> <span class="st">"cutDrift"</span>, <span class="co"># Give a human-readable name</span></span>
<span>      fun <span class="op">=</span> <span class="va">cutDrift_Sample</span>, <span class="co"># The function that is applied to the sample</span></span>
<span>      params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dt_from <span class="op">=</span> <span class="va">dt_from</span>, dt_to <span class="op">=</span> <span class="va">dt_to</span><span class="op">)</span> <span class="co"># The arguments that function needs</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">x</span><span class="op">$</span><span class="fu">appendDelayedOp</span><span class="op">(</span><span class="va">delayed_op</span><span class="op">)</span></span>
<span>    <span class="co"># Return the dataset, invisibly:</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level3">
<h3 id="example">Example:<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>Load the dataset:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annotations</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/create_annotations_table.html">create_annotations_table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,<span class="va">samples_directory</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; An annotation table was created</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The table now includes 3 samples</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Feel free to edit the table to include additional annotations as extra</span></span>
<span><span class="co">#&gt;   columns (for groups, phenotypes...), please avoid renaming the SampleID and</span></span>
<span><span class="co">#&gt;   FileName columns</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> You may freely add/remove rows to include/exclude additional samples</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> For editing, you can do it from R or you can check the examples at</span></span>
<span><span class="co">#&gt;   `help("create_annotations_table")` tolearn how to save the table to an Excel</span></span>
<span><span class="co">#&gt;   file at your convenience</span></span>
<span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/GCIMSDataset.html">GCIMSDataset</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">annotations</span>,</span>
<span>  base_dir <span class="op">=</span> <span class="va">samples_directory</span>,</span>
<span>  on_ram <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># You probably should set this to FALSE if you have more </span></span>
<span>                <span class="co"># than a handful of samples. See ?GCIMSDataset.</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dataset</span></span>
<span><span class="co">#&gt; A GCIMSDataset:</span></span>
<span><span class="co">#&gt; - With 3 samples</span></span>
<span><span class="co">#&gt; - Stored on RAM</span></span>
<span><span class="co">#&gt; - No phenotypes</span></span>
<span><span class="co">#&gt; - No previous history</span></span>
<span><span class="co">#&gt; - Queued operations:</span></span>
<span><span class="co">#&gt;   - read_sample:</span></span>
<span><span class="co">#&gt;       base_dir: /__w/GCIMS/GCIMS/vignettes/threeketones</span></span>
<span><span class="co">#&gt;       parser: default</span></span>
<span><span class="co">#&gt;   - setSampleNamesAsDescription</span></span></code></pre></div>
<p>Get the first sample of the dataset, and see the drift time vector at
indices 500 and 1200:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_before</span> <span class="op">&lt;-</span> <span class="va">dataset</span><span class="op">$</span><span class="fu">getSample</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dtime_before</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GCIMS-generics.html">dtime</a></span><span class="op">(</span><span class="va">sample_before</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dtime_before</span><span class="op">[</span><span class="fl">1000</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 6.66</span></span>
<span><span class="va">dtime_before</span><span class="op">[</span><span class="fl">1500</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 9.993333</span></span></code></pre></div>
<p>Cut the sample:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu">cutDrift_Dataset</span><span class="op">(</span><span class="va">dataset</span>, dt_from <span class="op">=</span> <span class="fl">1000</span>, dt_to <span class="op">=</span> <span class="fl">1500</span><span class="op">)</span> <span class="co"># indices</span></span>
<span><span class="va">dataset</span></span>
<span><span class="co">#&gt; A GCIMSDataset:</span></span>
<span><span class="co">#&gt; - With 3 samples</span></span>
<span><span class="co">#&gt; - Stored on RAM</span></span>
<span><span class="co">#&gt; - No phenotypes</span></span>
<span><span class="co">#&gt; - History:</span></span>
<span><span class="co">#&gt;   - read_sample:</span></span>
<span><span class="co">#&gt;       base_dir: /__w/GCIMS/GCIMS/vignettes/threeketones</span></span>
<span><span class="co">#&gt;       parser: default</span></span>
<span><span class="co">#&gt;   - setSampleNamesAsDescription</span></span>
<span><span class="co">#&gt; - Queued operations:</span></span>
<span><span class="co">#&gt;   - cutDrift:</span></span>
<span><span class="co">#&gt;       dt_from: 1000.0</span></span>
<span><span class="co">#&gt;       dt_to: 1500.0</span></span></code></pre></div>
<p>The dataset has now a pending operation, we can execute it:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span><span class="op">$</span><span class="fu">realize</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>And get the sample, modified:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_after</span> <span class="op">&lt;-</span> <span class="va">dataset</span><span class="op">$</span><span class="fu">getSample</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dtime_after</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GCIMS-generics.html">dtime</a></span><span class="op">(</span><span class="va">sample_after</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dtime_after</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 6.66</span></span>
<span><span class="va">dtime_after</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dtime_after</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 9.993333</span></span></code></pre></div>
<p>Same sample before and after:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample_before</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Before"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample_after</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"After"</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="creating-a-workflow-step_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="save-additional-information-within-each-sample">Save additional information within each sample<a class="anchor" aria-label="anchor" href="#save-additional-information-within-each-sample"></a>
</h2>
<p>Modifying your samples is something nice. Sometimes you want to save
some additional information in the sample that can help you analyze the
results.</p>
<p>You can do that with the <code>proc_params</code> slot.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cutDrift2_Sample</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">dt_from</span>, <span class="va">dt_to</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># dt_from and dt_to are indices of the drift time vector.</span></span>
<span>  <span class="co"># This function crops a sample in the drift time axis.</span></span>
<span>  </span>
<span>  <span class="co"># Check that we are given a sample</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"GCIMSSample"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Internal error, this will never happen"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Get the original range of the drift time</span></span>
<span>  <span class="va">original_dt_length</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/GCIMS-generics.html">dtime</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span>  <span class="co"># In the future we will provide accessors instead of using @ slots directly.</span></span>
<span>  <span class="va">x</span><span class="op">@</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">data</span><span class="op">[</span><span class="va">dt_from</span><span class="op">:</span><span class="va">dt_to</span>,<span class="op">]</span></span>
<span>  <span class="va">x</span><span class="op">@</span><span class="va">drift_time</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">drift_time</span><span class="op">[</span><span class="va">dt_from</span><span class="op">:</span><span class="va">dt_to</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">new_dt_length</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/GCIMS-generics.html">dtime</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Save it in the proc_params list:</span></span>
<span>  <span class="va">x</span><span class="op">@</span><span class="va">proc_params</span><span class="op">$</span><span class="va">cutDrift</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    original_dt_length <span class="op">=</span> <span class="va">original_dt_length</span>,</span>
<span>    new_dt_length <span class="op">=</span> <span class="va">new_dt_length</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Check that we return a valid sample:</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">validObject</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"The sample is not valid."</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We use the same function for the dataset:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cutDrift2_Dataset</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">dt_from</span>, <span class="va">dt_to</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">delayed_op</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DelayedOperation.html">DelayedOperation</a></span><span class="op">(</span></span>
<span>      name <span class="op">=</span> <span class="st">"cutDrift2"</span>, <span class="co"># Give a human-readable name</span></span>
<span>      fun <span class="op">=</span> <span class="va">cutDrift2_Sample</span>, <span class="co"># The function that is applied to the sample</span></span>
<span>      params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dt_from <span class="op">=</span> <span class="va">dt_from</span>, dt_to <span class="op">=</span> <span class="va">dt_to</span><span class="op">)</span> <span class="co"># The arguments that function needs</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">x</span><span class="op">$</span><span class="fu">appendDelayedOp</span><span class="op">(</span><span class="va">delayed_op</span><span class="op">)</span></span>
<span>    <span class="co"># Return the dataset, invisibly:</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level3">
<h3 id="example-1">Example<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/GCIMSDataset.html">GCIMSDataset</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">annotations</span>,</span>
<span>  base_dir <span class="op">=</span> <span class="va">samples_directory</span>,</span>
<span>  on_ram <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># You probably should set this to FALSE if you have more </span></span>
<span>                <span class="co"># than a handful of samples. See ?GCIMSDataset.</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dataset</span></span>
<span><span class="co">#&gt; A GCIMSDataset:</span></span>
<span><span class="co">#&gt; - With 3 samples</span></span>
<span><span class="co">#&gt; - Stored on RAM</span></span>
<span><span class="co">#&gt; - No phenotypes</span></span>
<span><span class="co">#&gt; - No previous history</span></span>
<span><span class="co">#&gt; - Queued operations:</span></span>
<span><span class="co">#&gt;   - read_sample:</span></span>
<span><span class="co">#&gt;       base_dir: /__w/GCIMS/GCIMS/vignettes/threeketones</span></span>
<span><span class="co">#&gt;       parser: default</span></span>
<span><span class="co">#&gt;   - setSampleNamesAsDescription</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu">cutDrift2_Dataset</span><span class="op">(</span><span class="va">dataset</span>, dt_from <span class="op">=</span> <span class="fl">1000</span>, dt_to <span class="op">=</span> <span class="fl">1500</span><span class="op">)</span> <span class="co"># indices</span></span>
<span><span class="va">dataset</span></span>
<span><span class="co">#&gt; A GCIMSDataset:</span></span>
<span><span class="co">#&gt; - With 3 samples</span></span>
<span><span class="co">#&gt; - Stored on RAM</span></span>
<span><span class="co">#&gt; - No phenotypes</span></span>
<span><span class="co">#&gt; - No previous history</span></span>
<span><span class="co">#&gt; - Queued operations:</span></span>
<span><span class="co">#&gt;   - read_sample:</span></span>
<span><span class="co">#&gt;       base_dir: /__w/GCIMS/GCIMS/vignettes/threeketones</span></span>
<span><span class="co">#&gt;       parser: default</span></span>
<span><span class="co">#&gt;   - setSampleNamesAsDescription</span></span>
<span><span class="co">#&gt;   - cutDrift2:</span></span>
<span><span class="co">#&gt;       dt_from: 1000.0</span></span>
<span><span class="co">#&gt;       dt_to: 1500.0</span></span></code></pre></div>
<p>The dataset has now a pending operation, we can execute it:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span><span class="op">$</span><span class="fu">realize</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>And get the sample, modified:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_after</span> <span class="op">&lt;-</span> <span class="va">dataset</span><span class="op">$</span><span class="fu">getSample</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>We have those parameters saved:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_after</span><span class="op">@</span><span class="va">proc_params</span><span class="op">$</span><span class="va">cutDrift</span></span>
<span><span class="co">#&gt; $original_dt_length</span></span>
<span><span class="co">#&gt; [1] 4500</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $new_dt_length</span></span>
<span><span class="co">#&gt; [1] 501</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="extracting-and-aggregating-information-from-samples-into-the-dataset">Extracting and aggregating information from samples into the
dataset<a class="anchor" aria-label="anchor" href="#extracting-and-aggregating-information-from-samples-into-the-dataset"></a>
</h2>
<p>In the previous example, we have to manually <code><a href="../reference/getSample.html">getSample()</a></code>
on each sample to get those additional results. This is going to be very
slow.</p>
<p>What we would like to have is a data frame with three columns: the
sample name, the original dt_length and the new dt_length, so we have a
summary for all the dataset.</p>
<p>For this to happen fast and efficiently, we need to do it in two
steps:</p>
<ul>
<li>Extraction: Extract (a small amount of) information from a
sample.</li>
<li>Aggregation: Aggregate the extracted information (e.g. to build your
dataframe)</li>
</ul>
<div class="section level3">
<h3 id="extraction">Extraction<a class="anchor" aria-label="anchor" href="#extraction"></a>
</h3>
<p>The extraction is usually a simple function that extracts from a
sample the information you need. Some workflow steps use it to extract
normalization factors, other workflow steps use it to extract the RIC or
the TIS.</p>
<p>Avoid extracting the whole data matrix, since it will use too much
RAM.</p>
<p>The function must take a GCIMSSample, and may return whatever you
need. If you need many things, return a list with all of them.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cutDrift_ExtractSample</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Check that we are given a sample</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"GCIMSSample"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Internal error, this will never happen"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Extract only what you need:</span></span>
<span>  <span class="va">extracted_object</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">proc_params</span><span class="op">$</span><span class="va">cutDrift</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">extracted_object</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level4">
<h4 id="check-that-it-works">Check that it works:<a class="anchor" aria-label="anchor" href="#check-that-it-works"></a>
</h4>
<p>You can check that your <code>*_ExtractSample</code> works by
applying it to one sample, if it has been processed:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cutDrift_ExtractSample</span><span class="op">(</span><span class="va">sample_after</span><span class="op">)</span></span>
<span><span class="co">#&gt; $original_dt_length</span></span>
<span><span class="co">#&gt; [1] 4500</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $new_dt_length</span></span>
<span><span class="co">#&gt; [1] 501</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="aggregation">Aggregation<a class="anchor" aria-label="anchor" href="#aggregation"></a>
</h3>
<p>The <code><a href="../reference/realize.html">realize()</a></code> method will extract the information from
all your samples and save all the extracted information on a list, as
long as the number of samples in your dataset.</p>
<p>Then, it will call the aggregation function, using the
<code>GCIMSDataset</code> as first argument and the list of extracted
information in the second argument.</p>
<p>We must write the aggregation function to convert our objects into
whatever we want (a data frame in our example) and save the outcome in
the dataset object.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cutDrift_Aggregate</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">extracted_objects</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Check that we are given a dataset</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"GCIMSDataset"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Internal error, this will never happen"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Check that we have as many extracted objects as samples:</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">extracted_objects</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">sampleNames</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># This should never happen:</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Internal error, we always have an extracted object for each sample"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Build the data frame that we want to generate</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    SampleName <span class="op">=</span> <span class="fu">sampleNames</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    orig_dt_length <span class="op">=</span> <span class="cn">NA_integer_</span>,</span>
<span>    new_dt_length <span class="op">=</span> <span class="cn">NA_integer_</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="co"># Fill it with information from the extracted objects:</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">extracted_objects</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">extracted_object</span> <span class="op">&lt;-</span> <span class="va">extracted_objects</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">df</span><span class="op">$</span><span class="va">orig_dt_length</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">extracted_object</span><span class="op">$</span><span class="va">original_dt_length</span></span>
<span>    <span class="va">df</span><span class="op">$</span><span class="va">new_dt_length</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">extracted_object</span><span class="op">$</span><span class="va">new_dt_length</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Save our dataframe in the dataset object:</span></span>
<span>  <span class="va">x</span><span class="op">$</span><span class="va">userData</span><span class="op">$</span><span class="va">cutDrift</span> <span class="op">&lt;-</span> <span class="va">df</span></span>
<span>  <span class="co"># We always return the whole dataset</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We now pass those extraction and aggregation functions as well:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cutDrift3_Dataset</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">dt_from</span>, <span class="va">dt_to</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">delayed_op</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DelayedOperation.html">DelayedOperation</a></span><span class="op">(</span></span>
<span>      name <span class="op">=</span> <span class="st">"cutDrift3"</span>, <span class="co"># Give a human-readable name</span></span>
<span>      fun <span class="op">=</span> <span class="va">cutDrift2_Sample</span>, <span class="co"># The function that is applied to the sample</span></span>
<span>      params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dt_from <span class="op">=</span> <span class="va">dt_from</span>, dt_to <span class="op">=</span> <span class="va">dt_to</span><span class="op">)</span>, <span class="co"># The arguments that function needs</span></span>
<span>      fun_extract <span class="op">=</span> <span class="va">cutDrift_ExtractSample</span>,</span>
<span>      fun_aggregate <span class="op">=</span> <span class="va">cutDrift_Aggregate</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">x</span><span class="op">$</span><span class="fu">appendDelayedOp</span><span class="op">(</span><span class="va">delayed_op</span><span class="op">)</span></span>
<span>    <span class="co"># Return the dataset, invisibly:</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-2">Example<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/GCIMSDataset.html">GCIMSDataset</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">annotations</span>,</span>
<span>  base_dir <span class="op">=</span> <span class="va">samples_directory</span>,</span>
<span>  on_ram <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># You probably should set this to FALSE if you have more </span></span>
<span>                <span class="co"># than a handful of samples. See ?GCIMSDataset.</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dataset</span></span>
<span><span class="co">#&gt; A GCIMSDataset:</span></span>
<span><span class="co">#&gt; - With 3 samples</span></span>
<span><span class="co">#&gt; - Stored on RAM</span></span>
<span><span class="co">#&gt; - No phenotypes</span></span>
<span><span class="co">#&gt; - No previous history</span></span>
<span><span class="co">#&gt; - Queued operations:</span></span>
<span><span class="co">#&gt;   - read_sample:</span></span>
<span><span class="co">#&gt;       base_dir: /__w/GCIMS/GCIMS/vignettes/threeketones</span></span>
<span><span class="co">#&gt;       parser: default</span></span>
<span><span class="co">#&gt;   - setSampleNamesAsDescription</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu">cutDrift3_Dataset</span><span class="op">(</span><span class="va">dataset</span>, dt_from <span class="op">=</span> <span class="fl">1000</span>, dt_to <span class="op">=</span> <span class="fl">1500</span><span class="op">)</span> <span class="co"># indices</span></span>
<span><span class="va">dataset</span></span>
<span><span class="co">#&gt; A GCIMSDataset:</span></span>
<span><span class="co">#&gt; - With 3 samples</span></span>
<span><span class="co">#&gt; - Stored on RAM</span></span>
<span><span class="co">#&gt; - No phenotypes</span></span>
<span><span class="co">#&gt; - No previous history</span></span>
<span><span class="co">#&gt; - Queued operations:</span></span>
<span><span class="co">#&gt;   - read_sample:</span></span>
<span><span class="co">#&gt;       base_dir: /__w/GCIMS/GCIMS/vignettes/threeketones</span></span>
<span><span class="co">#&gt;       parser: default</span></span>
<span><span class="co">#&gt;   - setSampleNamesAsDescription</span></span>
<span><span class="co">#&gt;   - cutDrift3:</span></span>
<span><span class="co">#&gt;       dt_from: 1000.0</span></span>
<span><span class="co">#&gt;       dt_to: 1500.0</span></span></code></pre></div>
<p>The dataset has now a pending operation, we can execute it:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span><span class="op">$</span><span class="fu">realize</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>And then get our data frame:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span><span class="op">$</span><span class="va">userData</span><span class="op">$</span><span class="va">cutDrift</span></span>
<span><span class="co">#&gt;      SampleName orig_dt_length new_dt_length</span></span>
<span><span class="co">#&gt; 1 220221_102919           4500           501</span></span>
<span><span class="co">#&gt; 2 220228_114404           4500           501</span></span>
<span><span class="co">#&gt; 3 220505_110658           4500           501</span></span></code></pre></div>
<p>Done!</p>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] GCIMS_0.1.1      cowplot_1.1.3    ggplot2_3.5.1    BiocStyle_2.32.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] sass_0.4.9          utf8_1.2.4          generics_0.1.3     </span></span>
<span><span class="co">#&gt;  [4] digest_0.6.37       magrittr_2.0.3      evaluate_1.0.1     </span></span>
<span><span class="co">#&gt;  [7] grid_4.4.1          bookdown_0.41       fastmap_1.2.0      </span></span>
<span><span class="co">#&gt; [10] jsonlite_1.8.9      ProtGenerics_1.36.0 BiocManager_1.30.25</span></span>
<span><span class="co">#&gt; [13] purrr_1.0.2         fansi_1.0.6         viridisLite_0.4.2  </span></span>
<span><span class="co">#&gt; [16] scales_1.3.0        codetools_0.2-20    textshaping_0.4.0  </span></span>
<span><span class="co">#&gt; [19] jquerylib_0.1.4     cli_3.6.3           rlang_1.1.4        </span></span>
<span><span class="co">#&gt; [22] Biobase_2.64.0      munsell_0.5.1       withr_3.0.1        </span></span>
<span><span class="co">#&gt; [25] cachem_1.1.0        yaml_2.3.10         parallel_4.4.1     </span></span>
<span><span class="co">#&gt; [28] tools_4.4.1         BiocParallel_1.38.0 dplyr_1.1.4        </span></span>
<span><span class="co">#&gt; [31] colorspace_2.1-1    sgolay_1.0.3        BiocGenerics_0.50.0</span></span>
<span><span class="co">#&gt; [34] curl_5.2.3          vctrs_0.6.5         R6_2.5.1           </span></span>
<span><span class="co">#&gt; [37] stats4_4.4.1        lifecycle_1.0.4     S4Vectors_0.42.1   </span></span>
<span><span class="co">#&gt; [40] fs_1.6.4            htmlwidgets_1.6.4   MASS_7.3-61        </span></span>
<span><span class="co">#&gt; [43] ragg_1.3.3          pkgconfig_2.0.3     desc_1.4.3         </span></span>
<span><span class="co">#&gt; [46] pkgdown_2.1.1       pillar_1.9.0        bslib_0.8.0        </span></span>
<span><span class="co">#&gt; [49] gtable_0.3.5        glue_1.8.0          systemfonts_1.1.0  </span></span>
<span><span class="co">#&gt; [52] highr_0.11          xfun_0.48           tibble_3.2.1       </span></span>
<span><span class="co">#&gt; [55] tidyselect_1.2.1    knitr_1.48          farver_2.1.2       </span></span>
<span><span class="co">#&gt; [58] htmltools_0.5.8.1   labeling_0.4.3      rmarkdown_2.28     </span></span>
<span><span class="co">#&gt; [61] signal_1.8-1        compiler_4.4.1</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sergio Oller Moreno, Celia Mallafré Muro, Luis Fernandez, Eduardo Caballero Saldivar, Arnau Blanco Borrego, Antonio Pardo Matínez, Santiago Marco Colás.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
