<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate the baseline of a GCIMS Sample using a connect local minima algorithm — estimateBaseline,GCIMSSample-method • GCIMS</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate the baseline of a GCIMS Sample using a connect local minima algorithm — estimateBaseline,GCIMSSample-method"><meta property="og:description" content="The baseline is estimated by connecting local minima and interpolating from those.
The local minima are identified as &quot;the minima in each region of length x&quot;
The length of the regions are estimated as fwhm * a multiplier / 2.3482. This
assumes it's several times"><meta property="og:image" content="https://sipss.github.io/GCIMS/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GCIMS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/creating-a-workflow-step.html">Creating a workflow step</a>
    </li>
    <li>
      <a href="../articles/importing-custom-data-formats.html">Importing custom data formats</a>
    </li>
    <li>
      <a href="../articles/introduction-to-gcims.html">Introduction to GCIMS</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate the baseline of a GCIMS Sample using a connect local minima algorithm</h1>
    
    <div class="hidden name"><code>estimateBaseline-GCIMSSample-method.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The baseline is estimated by connecting local minima and interpolating from those.
The local minima are identified as "the minima in each region of length x"
The length of the regions are estimated as <code>fwhm * a multiplier / 2.3482</code>. This
assumes it's several times</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for GCIMSSample</span></span>
<span><span class="fu"><a href="GCIMS-generics.html">estimateBaseline</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">dt_peak_fwhm_ms</span>, <span class="va">dt_region_multiplier</span>, <span class="va">rt_length_s</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for GCIMSSample</span></span>
<span><span class="fu"><a href="GCIMS-generics.html">baseline</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  dt_range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rt_range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dt_idx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rt_idx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .error_if_missing <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for GCIMSSample</span></span>
<span><span class="fu"><a href="GCIMS-generics.html">baseline</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>A <a href="GCIMSSample-class.html">GCIMSSample</a> object</p></dd>


<dt>dt_peak_fwhm_ms</dt>
<dd><p>Full Width at Half Maximum in milliseconds. Used to
determine the length of the regions where local minima are searched.</p></dd>


<dt>dt_region_multiplier</dt>
<dd><p>A multiplier to calculate the region</p></dd>


<dt>rt_length_s</dt>
<dd><p>The length of the baseline region. It should be
comparable or longer than the peak width</p></dd>


<dt>dt_range</dt>
<dd><p>The minimum and maximum drift times to extract (length 2 vector)</p></dd>


<dt>rt_range</dt>
<dd><p>The minimum and maximum retention times to extract (length 2 vector)</p></dd>


<dt>dt_idx</dt>
<dd><p>A numeric vector with the drift time indices to extract (or a logical vector of the length of drift time)</p></dd>


<dt>rt_idx</dt>
<dd><p>A numeric vector with the retention time indices to extract (or a logical vector of the length of retention time)</p></dd>


<dt>.error_if_missing</dt>
<dd><p>A logical. If <code>TRUE</code>, raise error if baseline has not been estimated. If <code>FALSE</code> returns <code>NULL</code> instead.</p></dd>


<dt>value</dt>
<dd><p>A matrix with the sample baseline of the same dimensions as <code>dim(object)</code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The modified <a href="GCIMSSample-class.html">GCIMSSample</a></p>


    </div>
    <div id="functions">
    <h2>Functions</h2>
    
<ul><li><p><code>baseline(GCIMSSample)</code>: Get the baseline</p></li>
<li><p><code>baseline(GCIMSSample) &lt;- value</code>: Set the baseline</p></li>
</ul></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Celia Mallafré Muro, Luis Fernandez, Sergio Oller Moreno, Arnau Blanco Borrego, Santiago Marco Colás.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

